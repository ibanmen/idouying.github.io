---
title: MySQL 之 七七八八
date: 2019-12-18 13:38:00
categories: Database
tags:
  - MySQL
---

MySQL记录——七七八八

<!--more-->

## Mysql 悲观锁（for update)

解锁条件：

1. 执行相同条件的 update
2. 执行 commit
3. 退出数据库 logout

检索的时候 如果不是主键和索引，有没有结果都会锁整表。

有主键或有索引（只有有一个就行，其他条件没有索引）有结果，行级锁，没结果，不会锁。

## mysql 中 tinyint、smallint、int、bigint 的区别

tinyint

从 -2^7 (-128) 到 2^7 - 1 (127) 的整型数据。存储大小为 1 个字节。

unsigned 是从 0 到 255 的整型数据。

所以建表的时候 只能是 tinyint(3),哪怕你建 tinyint(100)，他最大还是 3 位这么多。

smallint

从 -2^15 (-32,768) 到 2^15 - 1 (32,767) 的整型数据。存储大小为 2 个字节。

unsigned 是从 0 到 65535 的整型数据。

所以建表的时候 只能是 smallint(5),哪怕你建 smallint(100)，他最大还是 5 位这么多。

int

从 -2^31 (-2,147,483,648) 到 2^31 - 1 (2,147,483,647) 的整型数据（所有数字）.存储大小为 4 个字节。

unsigned 是从 0 到 4294967296 的整型数据。

所以建表的时候 只能是 int(10),哪怕你建 int(100)，他最大还是 10 位这么多。

bigint

从 -2^63 (-9,223,372,036,854,775,808) 到 2^63-1 (9,223,372,036,854,775,807) 的整型数据（所有数字）。存储大小为 8 个字节。

unsigned 是(自己算吧)

所以建表的时候 只能是 bigint(20),哪怕你建 bigint(100)，他最大还是 20 位这么多.

注意：

mysql 提供了五种整型： tinyint、smallint、mediumint、int 和 bigint。int 为 integer 的缩写。这些类型在可表示的取值范围上是不同的。 整数列可定义为 unsigned 从而禁用负值；这使列的取值范围为 0 以上。各种类型的存储量需求也是不同的。取值范围较大的类型所需的存储量较大。

mysql 提供三种浮点类型： float、double 和 decimal。与整型不同，浮点类型不能是 unsigned 的，其取值范围也与整型不同，这种不同不仅在于这些类型有最大 值，而且还有最小非零值。最小值提供了相应类型精度的一种度量，这对于记录科学数据来说是非常重要的（当然，也有负的最大和最小值）。

## 为什么 int 类型字段在 mysql 中默认 int(11) 无符号默认 int(10)？

int 类型在数据库中占 4 个字节（byte）,即 32 位

int 有符号类型 取值在 - 2147483648 ~ 2147483647 之间

int 无符号类型 取值在 0 ~ 4294967295 之间

```bash
有符号数最小值:
 - 2 1 4 7 4 8 3 6 4  8
 1 2 3 4 5 6 7 8 9 10 11    --共11位

 无符号数最大值:
 4 2 9 4 9 6 7 2 9 5
 1 2 3 4 5 6 7 8 9 10        --共10位
```

所以 mysql 默认显示的 int（11）和 unsign int（10）,只是表示存储数值显示后的位数，并不是实际存储的位数。

## Mysql text 可以存多少个汉字

以 utf8 编码计算的话

LANGTEXT：4294967295/3=1431655765 个汉字，14 亿，存储空间占用：4294967295/1024/1024/1024=4G 的数据；

MEDIUMTEXT：16777215/3=5592405 个汉字，560 万，存储空间占用：16777215/1024/1024=16M 的数据；

TEXT：65535/3=21845 个汉字，约 20000，存储空间占用：65535/1024=64K 的数据；
